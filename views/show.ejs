<%layout("/layout/boilerplate.ejs")%>
<script>
  const maptoken="<%=process.env.MAP_TOKEN%>";
const listing=<%-JSON.stringify(list)%>;
</script>


<div class="row mt-3">
    <div calss="col-8 offset-3">
<h3><%=list.title%></h3>
</div>
<div class="card col-6 offset-3 show-card listing-card" >
  <img src="<%=list.image.url%>" class="card-img-top show-img imgg" alt="listing_image">
  <p class="card-text"></p></i>
  <div class="card-body">
    <p class="card-text">
        
    <%=list.description%> <br>
    &#8377; <%=list.price.toLocaleString("en-IN")%> <br>
<%=list.location%> <br>
<%=list.country%> <br>
    </p>
  </div>
</div>
</div>
 <%if(currentUser&&currentUser._id.equals(list.owner._id)){%> 
   <div class="btns">
  <form method="GET"action="/listings/edit/<%=list._id%> " ><button class="btn btn-dark col-12 offset-3 edit-btn">edit</button></form>
  
   <form method="POST"action="/listings/delete/<%=list._id%>?_method=DELETE">
    <button class="btn btn-dark offset-3 delete-btn">delete</button>
</form>
</div>
<%}%>

<div class="col-8 offset-3 mb-3 show-card listing-card">
  <!-- ok -->

  <%if(currentUser){%>
    <hr>
  <h4>Leave a Review</h4>
  <p></p>
  <form action="/listings/<%=list._id%>/reviews" method="post"  novalidate class="needs-validation">
    <div class="mb-3 mt-3">
  <fieldset class="starability-fade">
  
  <input type="radio" id="no-rate" class="input-no-rate" name="review[rating]" value="1" checked aria-label="No rating." />

  <input type="radio" id="rate1" name="review[rating]" value="1" />
  <label for="rate1" title="Terrible">1 stars</label>

  <input type="radio" id="rate2" name="review[rating]" value="2" />
  <label for="rate2" title="Not good">2 stars</label>

  <input type="radio" id="rate3" name="review[rating]" value="3" />
  <label for="rate3" title="Average">3 stars</label>

  <input type="radio" id="rate4" name="review[rating]" value="4" />
  <label for="rate4" title="Very good">4 stars</label>

  <input type="radio" id="rate5" name="review[rating]" value="5" />
  <label for="rate5" title="Amazing">5 star</label>

</fieldset>
</div>
    <div class="mb-3 mt-3" >
      <label for="content" class="form-label">Comments</label>
      <textarea col="30" row="5" name="review[content]" id="comment"cols="30" rows="10" class="form-control" required></textarea>
      <div class="invalid-feedback">Please add some comment for review</div>
        
    </div>
    <button class="btn btn-dark">Submit</button>
</form> 
  <%}%>
  
<hr>
  <% if(list.reviews.length>0){%>
  <div class="row">
    <p><b>All Reviews</b></p>
  <% for(review of list.reviews){%>
    <div class="card col-5 ms-3 mb-3">
  <div class="card-body">
    <h5 class="card-title">@<%=review.author.username%></h5>
    <p class="starability-result" data-rating="<%=review.rating%>">
    
  </p>
      <p class="card-text"><%=review.content%></p>
      <p class="card-text"></p>
        
  
  </div>
  </div>
 <%if(currentUser&&currentUser._id.equals(review.author._id)){%>
  <form class="mb-3" method="post" action="/listings/<%=list._id%>/reviews/<%=review._id%>?_method=DELETE">
    <button class="btn btn-sm btn-dark ">Delete</button>
  </form>
  <%}%>
  <%}%>
  </div>
  <%}%>
  </div>
  <div class="col-6 offset-3 mb-3">
    <h3>Where you'll be</h3>
    <div id='map'></div>
   
  </div>
  </div>
<script src="/js/map.js"></script>



